<div class="wheel-game">
    <!-- START SCREEN -->
    <div class="start-screen" *ngIf="gameState === 'start'">
        <div class="game-title">
            <h1 class="title-questions">ุนุฌูุฉ</h1>
            <h2 class="title-wheel">ุงูุฃุณุฆูุฉ</h2>
        </div>

        <button class="start-btn" (click)="startGame()">ุงุจุฏุฃ ุงููุนุจ</button>

        <!-- Wheel Preview -->
        <svg class="wheel-preview" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="48" fill="none" stroke="#373738" stroke-width="2" />
            <ng-container *ngFor="let segment of scoreLevels">
                <path [attr.d]="segment.path" [attr.fill]="segment.color" />
                <text [attr.x]="segment.textX" [attr.y]="segment.textY" fill="white" font-size="8" font-family="Arial"
                    font-weight="bold" text-anchor="middle"
                    [attr.transform]="'rotate(' + segment.textRotate + ', ' + segment.textX + ', ' + segment.textY + ')'">{{
                    segment.label }}</text>
            </ng-container>
            <circle cx="50" cy="50" r="8" fill="#373738" />
        </svg>
    </div>

    <!-- INSTRUCTIONS SCREEN -->
    <div class="instructions-screen" *ngIf="gameState === 'instructions'">
        <div class="timer-preview">
            <span>โฑ๏ธ</span>
            <span>01:30</span>
        </div>
        <p class="timer-note">ูุฏูู ูุฐุง ุงูููุช ููุท!</p>

        <h2 class="instructions-title">ุงูุชุนูููุงุช</h2>

        <p class="instructions-text">
            ุฃุฏุฑ ุงูุนุฌูุฉ ููุญุตูู ุนูู ุณุคุงู.<br>
            ูู ููู ููุซู ุนุฏุฏุงู ูู ุงูููุงุท (+1 ุฅูู +6).<br>
            ุฃุฌุจ ุนูู ุฃูุจุฑ ุนุฏุฏ ูู ุงูุฃุณุฆูุฉ ูุจู ุงูุชูุงุก ุงูููุช!
        </p>

        <button class="understood-btn" (click)="beginPlaying()">ูููุช! ๐</button>
    </div>

    <!-- PLAYING SCREEN -->
    <div class="playing-screen" *ngIf="gameState === 'playing'">
        <!-- Header with Timer -->
        <div class="game-header">
            <div class="timer-display" [class.warning]="timeLeft <= 10">
                <span>โฑ๏ธ</span>
                <span>{{ formatTime(timeLeft) }}</span>
            </div>
        </div>

        <!-- Score -->
        <div class="score-display">
            ุงูููุงุท: <strong>{{ score }}</strong>
        </div>

        <!-- Wheel Only (No Grid) -->

        <!-- Wheel -->
        <div class="wheel-container">
            <div class="wheel-pointer"></div>
            <div class="wheel" [class.spinning]="isSpinning" [style.transform]="'rotate(' + wheelRotation + 'deg)'"
                (click)="spinWheel()">
                <svg viewBox="0 0 100 100" style="width:100%; height:100%;">
                    <ng-container *ngFor="let segment of scoreLevels">
                        <path [attr.d]="segment.path" [attr.fill]="segment.color" />
                        <text [attr.x]="segment.textX" [attr.y]="segment.textY" fill="white" font-size="8"
                            font-family="Arial" font-weight="bold" text-anchor="middle"
                            [attr.transform]="'rotate(' + segment.textRotate + ', ' + segment.textX + ', ' + segment.textY + ')'">{{
                            segment.label }}</text>
                    </ng-container>
                </svg>
                <div class="wheel-center"></div>
            </div>
        </div>
    </div>

    <!-- QUESTION MODAL -->
    <div class="question-overlay" *ngIf="gameState === 'question' && currentQuestion">
        <div class="question-modal" [style.borderColor]="selectedScoreLevel?.color">

            <div class="modal-header" [style.background]="selectedScoreLevel?.color">
                <h3>ุณุคุงู {{ selectedScoreLevel?.points }} ููุงุท</h3>
                <button class="close-btn" (click)="closeQuestion()">โฉ๏ธ</button>
            </div>

            <p class="question-text">{{ currentQuestion.text }}</p>

            <div class="options-grid">
                <button *ngFor="let option of currentQuestion.options" class="option-btn"
                    [class.selected]="selectedAnswer === option && !answerResult"
                    [class.correct]="answerResult && option === currentQuestion.correctAnswer"
                    [class.wrong]="answerResult === 'wrong' && selectedAnswer === option"
                    (click)="selectAnswer(option)">
                    {{ option }}
                </button>
            </div>

            <div class="points-feedback" *ngIf="answerResult" [class.positive]="answerResult === 'correct'"
                [class.negative]="answerResult === 'wrong'">
                {{ pointsChange > 0 ? '+' : '' }}{{ pointsChange }} ููุงุท
            </div>
        </div>
    </div>

    <!-- RESULTS SCREEN -->
    <div class="results-screen" *ngIf="gameState === 'results'">
        <h2 class="results-title">๐ ุงูุชูู ุงูููุช!</h2>

        <div class="final-score">{{ score }} ููุทุฉ</div>

        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value">{{ questionsAnswered }}</div>
                <div class="stat-label">ุฅุฌูุงูู ุงูุฃุณุฆูุฉ</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">{{ correctAnswers }}</div>
                <div class="stat-label">ุฅุฌุงุจุงุช ุตุญูุญุฉ</div>
            </div>
        </div>

        <div class="results-buttons">
            <button class="play-again-btn" (click)="playAgain()">ุงูุนุจ ูุฑุฉ ุฃุฎุฑู ๐</button>
            <button class="home-btn" (click)="goHome()">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ ๐</button>
        </div>
    </div>
</div>